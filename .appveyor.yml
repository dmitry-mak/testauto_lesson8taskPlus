version: 1.0.{build}

branches:
  only:
    - main

image: Ubuntu2004

install:

  - sh: docker-compose up -d
  - sh: sleep 30
  - sh: sudo apt-get update && sudo apt-get install -y openjdk-11-jdk
  - sh: chmod +x gradlew

build_script:
  - sh: java -jar ./artifacts/app-deadline.jar &
  - sh: ./gradlew test --info

cache:
  - .gradle -> .gradle

artifacts:
  - path: build/reports/tests/test
    name: test-reports